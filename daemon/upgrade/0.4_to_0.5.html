<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Upgrading 0.4.X to 0.5.X | Pterodactyl</title>
    <meta name="description" content="The open-source server management solution.">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#0e4688">
  <link rel="manifest" href="/favicons/manifest.json">
  <link rel="shortcut icon" href="/favicons/favicon.ico">
  <meta name="msapplication-config" content="/favicons/browserconfig.xml">
  <meta name="theme-color" content="#0e4688">
    
    <link rel="preload" href="/assets/css/0.styles.55a8b33d.css" as="style"><link rel="preload" href="/assets/js/app.4bcf8b42.js" as="script"><link rel="preload" href="/assets/js/28.a668c12e.js" as="script"><link rel="prefetch" href="/assets/js/2.246d7148.js"><link rel="prefetch" href="/assets/js/3.9f7c152a.js"><link rel="prefetch" href="/assets/js/4.c77d3519.js"><link rel="prefetch" href="/assets/js/5.c1484b54.js"><link rel="prefetch" href="/assets/js/6.46512893.js"><link rel="prefetch" href="/assets/js/7.cb7ac953.js"><link rel="prefetch" href="/assets/js/8.b77b5e9f.js"><link rel="prefetch" href="/assets/js/9.11ff24f5.js"><link rel="prefetch" href="/assets/js/10.fc0e3859.js"><link rel="prefetch" href="/assets/js/11.7a2275fc.js"><link rel="prefetch" href="/assets/js/12.02e687eb.js"><link rel="prefetch" href="/assets/js/13.ea7b9dae.js"><link rel="prefetch" href="/assets/js/14.a8602317.js"><link rel="prefetch" href="/assets/js/15.11bef37b.js"><link rel="prefetch" href="/assets/js/16.ed492d11.js"><link rel="prefetch" href="/assets/js/17.39b7711c.js"><link rel="prefetch" href="/assets/js/18.02120422.js"><link rel="prefetch" href="/assets/js/19.8353394f.js"><link rel="prefetch" href="/assets/js/20.fe9ea952.js"><link rel="prefetch" href="/assets/js/21.601886ac.js"><link rel="prefetch" href="/assets/js/22.ff19391b.js"><link rel="prefetch" href="/assets/js/23.c3070e00.js"><link rel="prefetch" href="/assets/js/24.40ed644e.js"><link rel="prefetch" href="/assets/js/25.26a8a4e9.js"><link rel="prefetch" href="/assets/js/26.5b2971f2.js"><link rel="prefetch" href="/assets/js/27.d57d3226.js"><link rel="prefetch" href="/assets/js/29.1a50e21b.js"><link rel="prefetch" href="/assets/js/30.8c290954.js"><link rel="prefetch" href="/assets/js/31.3380c08b.js"><link rel="prefetch" href="/assets/js/32.d827cd5e.js"><link rel="prefetch" href="/assets/js/33.2572d233.js"><link rel="prefetch" href="/assets/js/34.19aa808b.js"><link rel="prefetch" href="/assets/js/35.575d3104.js"><link rel="prefetch" href="/assets/js/36.a5190b64.js"><link rel="prefetch" href="/assets/js/37.272d181e.js"><link rel="prefetch" href="/assets/js/38.2e71e0c0.js"><link rel="prefetch" href="/assets/js/39.466d20d5.js"><link rel="prefetch" href="/assets/js/40.eed68b07.js"><link rel="prefetch" href="/assets/js/41.4fc5d55c.js"><link rel="prefetch" href="/assets/js/42.b7f698c5.js"><link rel="prefetch" href="/assets/js/43.ca13b49e.js"><link rel="prefetch" href="/assets/js/44.b573964e.js"><link rel="prefetch" href="/assets/js/45.49114d63.js"><link rel="prefetch" href="/assets/js/46.d84a855b.js"><link rel="prefetch" href="/assets/js/47.d08eccbf.js"><link rel="prefetch" href="/assets/js/48.a341c150.js"><link rel="prefetch" href="/assets/js/49.eeac0293.js"><link rel="prefetch" href="/assets/js/50.821f7427.js">
    <link rel="stylesheet" href="/assets/css/0.styles.55a8b33d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="nav"><div class="sidebar-button block md:hidden flex-no-shrink"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <div class="logo-container"><a href="/" class="home-link router-link-active"><img src="/pterodactyl-flat.png" class="logo"> <span class="site-name hidden md:inline can-hide">
    Pterodactyl
  </span></a></div> <div class="w-full"><div class="flex"><div class="search-box"><input aria-label="Search" placeholder="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links flex-no-shrink hidden md:flex"><div class="nav-item"><a href="/project/introduction.html" class="nav-link">Documentation
</a></div><div class="nav-item"><a href="/community/about.html" class="nav-link">Community Guides
</a></div><div class="nav-item"><a href="https://pterodactyl.io/discord" target="_blank" rel="noopener noreferrer" class="nav-link external">
    Get Help
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <div class="nav-item"><a href="https://github.com/pterodactyl/panel" target="_blank" rel="noopener noreferrer" class="nav-link">
            Contribute
            <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></nav></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links flex-no-shrink block md:hidden"><div class="nav-item"><a href="/project/introduction.html" class="nav-link">Documentation
</a></div><div class="nav-item"><a href="/community/about.html" class="nav-link">Community Guides
</a></div><div class="nav-item"><a href="https://pterodactyl.io/discord" target="_blank" rel="noopener noreferrer" class="nav-link external">
    Get Help
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <div class="nav-item"><a href="https://github.com/pterodactyl/panel" target="_blank" rel="noopener noreferrer" class="nav-link">
            Contribute
            <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Project Information</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/project/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/project/about.html" class="sidebar-link">About</a></li><li><a href="/project/terms.html" class="sidebar-link">Terminology</a></li><li><a href="/project/community.html" class="sidebar-link">Community Standards</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Panel</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/panel/getting_started.html" class="sidebar-link">Getting Started</a></li><li><a href="/panel/webserver_configuration.html" class="sidebar-link">Webserver Configuration</a></li><li><a href="/panel/upgrading.html" class="sidebar-link">Upgrading</a></li><li><a href="/panel/configuration.html" class="sidebar-link">Environment Configuration</a></li><li><a href="/panel/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Daemon</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/daemon/installing.html" class="sidebar-link">Installation</a></li><li><a href="/daemon/upgrading.html" class="sidebar-link">Upgrading</a></li><li><a href="/daemon/configuration.html" class="sidebar-link">Additional Configuration</a></li><li><a href="/daemon/kernel_modifications.html" class="sidebar-link">Kernel Modifications</a></li><li><a href="/daemon/debian_8_docker.html" class="sidebar-link">Docker on Debian 8</a></li><li><a href="/daemon/standalone_sftp.html" class="sidebar-link">Standalone SFTP Server</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Tutorials</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/tutorials/mysql_setup.html" class="sidebar-link">Setting up MySQL</a></li><li><a href="/tutorials/creating_ssl_certificates.html" class="sidebar-link">Creating SSL Certificates</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Development &amp; Ops</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="upgrading-0-4-x-to-0-5-x"><a href="#upgrading-0-4-x-to-0-5-x" aria-hidden="true" class="header-anchor">#</a> Upgrading 0.4.X to 0.5.X</h1> <p></p><div class="table-of-contents"><ul><li><a href="#docker-adjustments">Docker Adjustments</a></li><li><a href="#download-files">Download Files</a></li><li><a href="#sftp-cleanup">SFTP Cleanup</a></li><li><a href="#file-migration">File Migration</a><ul><li><a href="#rebuild-containers">Rebuild Containers</a></li></ul></li></ul></div><p></p> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>This upgrade process will require that <strong>all</strong> servers running through the Daemon be offline for a short period
of time while data is reorganized and server containers are rebuilt. Please plan accordingly for this.</p> <p>You will need to update your Panel to the 0.7.X series in order to complete this process as well.</p></div> <h2 id="docker-adjustments"><a href="#docker-adjustments" aria-hidden="true" class="header-anchor">#</a> Docker Adjustments</h2> <p>Previously we provided a quick Docker installation script in our installation instructions. We made the regrettable
mistake of not reading deeper into it and realizing it enabled edge release channels for Docker. You'll want to take
a look at the official documentation for Docker and change your channel to be a stable release channel.</p> <p>Please reference the official Docker documentation for how to install Docker CE on your server. Some quick links
are listed below for commonly supported systems.</p> <ul><li><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-docker-ce" target="_blank" rel="noopener noreferrer">Ubuntu<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce" target="_blank" rel="noopener noreferrer">CentOS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.docker.com/install/linux/docker-ce/debian/#install-docker-ce" target="_blank" rel="noopener noreferrer">Debian<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="download-files"><a href="#download-files" aria-hidden="true" class="header-anchor">#</a> Download Files</h2> <p>To upgrade from v0.4.X first switch the directory where you installed your Daemon. If you followed the installation
guide your Daemon is most likely located in <code>/srv/daemon</code>. Then, download and unpack the archive using the
command below.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> -L https://github.com/pterodactyl/daemon/releases/download/v0.5.7/daemon.tar.gz <span class="token operator">|</span> <span class="token function">tar</span> --strip-components<span class="token operator">=</span>1 -xzv
</code></pre></div><p>Then, update the core dependencies for the Daemon with the following command.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> update --only<span class="token operator">=</span>production
</code></pre></div><h2 id="sftp-cleanup"><a href="#sftp-cleanup" aria-hidden="true" class="header-anchor">#</a> SFTP Cleanup</h2> <p>This version of the Daemon ships with an internal SFTP subsystem, no more need for a special Docker container or
confusing file permissions. For the most part the Daemon can handle all of the internal changes that make this possible,
you'll just need to remove the old Docker container for SFTP.</p> <p>To do so, simply run the following commands, changing <code>2022</code> if you are using a different port.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker rmi -f quay.io/pterodactyl/scrappy
<span class="token function">sudo</span> <span class="token function">kill</span> <span class="token variable"><span class="token variable">$(</span> <span class="token function">sudo</span> <span class="token function">lsof</span> -i:2022 -t <span class="token variable">)</span></span>
</code></pre></div><p>Once you have completed that step, you will need to boot the Daemon in order to have the new system user created
automatically. This can be done by running <code>sudo npm start</code> in the Daemon directory. You'll want to run it in the
foreground in order to monitor progress and make sure it executes without issues. Once it has finished running and
the Daemon is up and running, stop it again using <code>CTRL+C</code>.</p> <p>If for whatever reason you need your user to be named something other than <code>pterodactyl</code> you can change that in the
<code>core.json</code> before booting the Daemon by setting the <code>docker.container.username</code> key. 99.9% of users will not need
to change the username.</p> <h2 id="file-migration"><a href="#file-migration" aria-hidden="true" class="header-anchor">#</a> File Migration</h2> <p>Now for the longest part of the upgrade: data migration. You only need to migrate data once when updating from v0.4.X.</p> <p>You'll need all of your servers to be stopped for this part of the migration. All of their containers will also need
to be rebuilt, but this will be completed on the Panel with a console command since we also need to update their
configurations with some new data. We will run that command after we migrate all of the data.</p> <p>To perform this migration, simply run the command below in the Daemon directory and follow its prompts. Be aware it
might take a few minutes to run, especially with large volumes of data.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">npm</span> run migrate
docker system prune
</code></pre></div><h3 id="rebuild-containers"><a href="#rebuild-containers" aria-hidden="true" class="header-anchor">#</a> Rebuild Containers</h3> <p>After migrating your data, you'll also need to run a command on the Panel in order to update all of the configurations
for these servers. First, be sure to boot the Daemon in foreground mode (<code>sudo npm start</code>). You'll then want to run the
following command in the Panel directory, <strong>not the Daemon directory</strong>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan p:server:rebuild --node<span class="token operator">=</span><span class="token comment">###</span>
</code></pre></div><p>Replace <code>###</code> above with the ID of your node that is being updated. This will toggle all servers for a rebuild, as
well as push the latest information to their configurations. Once this is done, stop the Daemon, run the command below,
and then boot it. If you have all daemons running and wish to update them all at once, remove the <code>--node</code> flag.</p> <p>Boot the Daemon one last time in the foreground, make sure it completes without errors, and then you can stop it and
restart it using your service: <code>sudo systemctl start wings</code>.</p> <div class="tip custom-block"><p class="custom-block-title">Thanks!</p> <p>You're all finished! Thanks for bearing with us, this update addresses a lot of flaws in the previous implementations
of the software, and also prepares your data for the eventual migration to our new daemon â€” which is still in the works.</p></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/pterodactyl/documentation/edit/master/daemon/upgrade/0.4_to_0.5.md" target="_blank" rel="noopener noreferrer">Help us improve this page.</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div></div></div>
    <script src="/assets/js/28.a668c12e.js" defer></script><script src="/assets/js/app.4bcf8b42.js" defer></script>
  </body>
</html>
